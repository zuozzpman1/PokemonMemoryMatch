<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pokemon Games!</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=ZCOOL+KuaiLe&display=swap" rel="stylesheet">
</head>

<body>
    <!-- Mode Selector Screen -->
    <div id="mode-selector" class="screen">
        <div class="mode-selector-container">
            <h1 class="mode-title">Pokemon Games!</h1>
            <div class="mode-buttons">
                <button id="mode-memory-btn" class="mode-btn mode-btn-memory">
                    <span class="mode-icon">üÉè</span>
                    <span class="mode-label">Memory Match</span>
                </button>
                <button id="mode-battle-btn" class="mode-btn mode-btn-battle">
                    <span class="mode-icon">‚öîÔ∏è</span>
                    <span class="mode-label">Pokemon Battle</span>
                </button>
                <button id="mode-collection-btn" class="mode-btn mode-btn-collection">
                    <span class="mode-icon">üèÜ</span>
                    <span class="mode-label">Collection</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Battle Mode Selector Screen -->
    <div id="battle-mode-selector" class="screen hidden">
        <div class="mode-selector-container">
            <h1 class="mode-title">Pokemon Battle</h1>
            <div class="mode-buttons">
                <button id="battle-vs-cpu-btn" class="mode-btn mode-btn-memory">
                    <span class="mode-icon">ü§ñ</span>
                    <span class="mode-label">vs CPU</span>
                </button>
                <button id="battle-vs-online-btn" class="mode-btn mode-btn-battle">
                    <span class="mode-icon">üåê</span>
                    <span class="mode-label">Online</span>
                </button>
            </div>
            <button id="battle-mode-back-btn" class="battle-nav-btn lobby-back-btn">Back</button>
        </div>
    </div>

    <!-- Memory Match Screen (existing game) -->
    <div id="memory-screen" class="screen hidden">
        <div class="game-container">
            <header>
                <h1>Pokemon Memory Match</h1>
                <div class="stats-bar">
                    <span id="score">Score: 0</span>
                    <button id="restart-btn">Restart</button>
                </div>
            </header>

            <main class="game-board" id="game-board">
                <!-- Cards will be generated here by JS -->
            </main>

            <div id="victory-modal" class="hidden">
                <div class="modal-content">
                    <h2>Good Job Damian!</h2>
                    <div class="stars">‚òÖ‚òÖ‚òÖ</div>
                    <button id="play-again-btn">Play Again</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Team Picker Screen -->
    <div id="team-picker" class="screen hidden">
        <div class="game-container team-picker-container">
            <header class="team-picker-header">
                <button id="team-picker-back-btn" class="battle-nav-btn">Back</button>
                <h1 class="team-picker-title">Pick Your Team!</h1>
                <div id="team-counter" class="team-counter">0 / 3</div>
            </header>
            <div id="team-picker-grid" class="team-picker-grid">
                <!-- Pokemon cards rendered by JS -->
            </div>
            <div class="team-picker-footer">
                <button id="start-battle-btn" class="battle-action-btn start-battle-btn" disabled>Battle!</button>
            </div>
        </div>
    </div>

    <!-- HP Battle Screen -->
    <div id="hp-battle-screen" class="screen hidden">
        <div class="game-container hp-battle-container">
            <header class="hp-battle-header">
                <button id="hp-battle-menu-btn" class="battle-nav-btn">Menu</button>
                <div class="team-dots-area">
                    <div id="cpu-team-dots" class="team-dots cpu-dots"></div>
                    <div id="player-team-dots" class="team-dots player-dots"></div>
                </div>
            </header>

            <!-- CPU Pokemon Display -->
            <div id="cpu-pokemon-display" class="hp-pokemon-display cpu-side">
                <div class="hp-pokemon-info">
                    <span id="cpu-pokemon-name" class="hp-pokemon-name">???</span>
                    <span id="cpu-pokemon-type" class="type-badge type-normal">normal</span>
                </div>
                <div class="hp-bar-container">
                    <div id="cpu-hp-bar" class="hp-bar-fill" style="width: 100%"></div>
                </div>
                <div id="cpu-hp-text" class="hp-text">25 / 25</div>
                <div class="hp-sprite-area">
                    <img id="cpu-pokemon-sprite" class="hp-pokemon-sprite cpu-sprite" src="" alt="">
                    <div id="cpu-damage-callout" class="damage-callout hidden"></div>
                </div>
            </div>

            <!-- VS Badge -->
            <div class="vs-badge hp-vs-badge">VS</div>

            <!-- Player Pokemon Display -->
            <div id="player-pokemon-display" class="hp-pokemon-display player-side">
                <div class="hp-sprite-area">
                    <img id="player-pokemon-sprite" class="hp-pokemon-sprite player-sprite" src="" alt="">
                    <div id="player-damage-callout" class="damage-callout hidden"></div>
                </div>
                <div class="hp-pokemon-info">
                    <span id="player-pokemon-name" class="hp-pokemon-name">???</span>
                    <span id="player-pokemon-type" class="type-badge type-normal">normal</span>
                </div>
                <div class="hp-bar-container">
                    <div id="player-hp-bar" class="hp-bar-fill" style="width: 100%"></div>
                </div>
                <div id="player-hp-text" class="hp-text">20 / 20</div>
            </div>

            <!-- Type Triangle Helper -->
            <div class="type-triangle-helper">
                <span class="tri-fire">üî•</span> &gt; <span class="tri-grass">üåø</span> &gt; <span class="tri-water">üíß</span> &gt; <span class="tri-fire">üî•</span>
            </div>
        </div>
    </div>

    <!-- Online Waiting Overlay (team picker + battle) -->
    <div id="online-waiting-overlay" class="online-waiting-overlay hidden">
        <div class="online-waiting-content">
            <div class="lobby-waiting">
                <span class="lobby-waiting-dot"></span>
                <span id="online-waiting-text">Waiting for opponent...</span>
            </div>
        </div>
    </div>

    <!-- Switch Pokemon Overlay (forced, no cancel) -->
    <div id="switch-overlay" class="switch-overlay hidden">
        <div class="switch-overlay-content">
            <h2 class="switch-overlay-title">Choose Next Pokemon!</h2>
            <div id="switch-pokemon-list" class="switch-pokemon-list"></div>
        </div>
    </div>

    <!-- HP Battle Result Modal -->
    <div id="hp-battle-result-modal" class="battle-result-modal hidden">
        <div class="modal-content battle-modal-content">
            <h2 id="hp-battle-winner-text">You Win!</h2>
            <div id="hp-battle-sticker" class="battle-sticker hidden">
                <img id="hp-sticker-sprite" class="sticker-sprite" src="" alt="">
                <div class="sticker-text">New Sticker!</div>
            </div>
            <div id="hp-battle-streak" class="battle-streak"></div>
            <div class="battle-modal-buttons">
                <button id="hp-battle-again-btn" class="battle-action-btn">Battle Again!</button>
                <button id="hp-battle-menu-btn-modal" class="battle-action-btn battle-menu-action">Main Menu</button>
            </div>
        </div>
    </div>

    <!-- Collection Screen -->
    <div id="collection-screen" class="screen hidden">
        <div class="game-container collection-container">
            <header class="collection-header">
                <button id="collection-back-btn" class="battle-nav-btn">Back</button>
                <h1 class="collection-title">My Collection</h1>
                <div id="win-streak-display" class="win-streak-display"></div>
            </header>
            <div id="collection-grid" class="collection-grid">
                <!-- Collection cards rendered by JS -->
            </div>
        </div>
    </div>

    <!-- Battle Lobby Screen (online mode) -->
    <div id="battle-lobby" class="screen hidden">
        <div class="mode-selector-container">
            <h1 class="mode-title">Online Battle</h1>

            <!-- Create or Join -->
            <div id="lobby-online-choice" class="lobby-panel">
                <div class="mode-buttons">
                    <button id="lobby-create-btn" class="mode-btn mode-btn-memory">
                        <span class="mode-icon">üè†</span>
                        <span class="mode-label">Create Room</span>
                    </button>
                    <button id="lobby-join-btn" class="mode-btn mode-btn-battle">
                        <span class="mode-icon">üîó</span>
                        <span class="mode-label">Join Room</span>
                    </button>
                </div>
                <button id="lobby-online-back-btn" class="battle-nav-btn lobby-back-btn">Back</button>
            </div>

            <!-- Create Room - waiting -->
            <div id="lobby-create-view" class="lobby-panel hidden">
                <div class="lobby-status-text">Room Code:</div>
                <div id="lobby-room-code" class="lobby-room-code">----</div>
                <div class="lobby-waiting">
                    <span class="lobby-waiting-dot"></span>
                    Waiting for opponent...
                </div>
                <button id="lobby-create-back-btn" class="battle-nav-btn lobby-back-btn">Cancel</button>
            </div>

            <!-- Join Room - input -->
            <div id="lobby-join-view" class="lobby-panel hidden">
                <div class="lobby-status-text">Enter Room Code:</div>
                <input id="lobby-code-input" class="lobby-code-input" type="text" maxlength="4" inputmode="numeric" pattern="[0-9]*" placeholder="0000">
                <button id="lobby-connect-btn" class="battle-action-btn lobby-connect-btn">Connect</button>
                <div id="lobby-join-status" class="lobby-join-status"></div>
                <button id="lobby-join-back-btn" class="battle-nav-btn lobby-back-btn">Back</button>
            </div>
        </div>
    </div>

    <canvas id="confetti-canvas"></canvas>

    <script src="https://unpkg.com/peerjs@1.5.4/dist/peerjs.min.js"></script>
    <script src="js/script.js"></script>
</body>

</html>
